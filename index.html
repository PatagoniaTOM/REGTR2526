<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro diario de superficie Patagoniafresh</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #ffffff;
            color: #333;
            line-height: 1.6;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .logo {
            max-width: 300px;
            margin-bottom: 20px;
        }
        
        h1 {
            font-size: 25px;
            color: #2c3e50;
            margin-bottom: 30px;
        }
        
        .button-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            margin-bottom: 40px;
        }
        
        .btn {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 15px 25px;
            background-color: #1b5e20;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            font-weight: 600;
            transition: background-color 0.3s;
            min-width: 250px;
        }
        
        .btn:hover {
            background-color: #2e7d32;
        }
        
        .btn i {
            margin-right: 10px;
        }
        
        .form-container {
            background-color: #f9f9f9;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            margin-bottom: 40px;
        }
        
        .form-section {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        h2 {
            font-size: 20px;
            margin-bottom: 20px;
            color: #2c3e50;
            display: flex;
            align-items: center;
        }
        
        h2 i {
            margin-right: 10px;
            color: #388e3c;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        select, input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        
        .submit-btn {
            background-color: #1b5e20;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 5px;
            cursor: pointer;
            display: block;
            margin: 30px auto 0;
            transition: background-color 0.3s;
        }
        
        .submit-btn:hover {
            background-color: #2e7d32;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 100;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
        }
        
        .modal-title {
            font-size: 22px;
            margin-bottom: 20px;
            color: #2c3e50;
            text-align: center;
        }
        
        .modal-data {
            margin-bottom: 25px;
            line-height: 1.8;
        }
        
        .modal-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        
        .modal-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
        }
        
        .modal-confirm {
            background-color: #1b5e20;
            color: white;
        }
        
        .modal-cancel {
            background-color: #f5f5f5;
            color: #333;
        }
        
        .success-modal {
            text-align: center;
        }
        
        .success-icon {
            font-size: 50px;
            color: #4caf50;
            margin-bottom: 20px;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #eaeaea;
            color: #7f8c8d;
            font-size: 14px;
        }
        
        @media (max-width: 768px) {
            .button-container {
                flex-direction: column;
                align-items: center;
            }
            
            .form-container {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <header>
        <img src="https://patagoniafresh.com/wp-content/uploads/2025/03/logo.png" alt="Logo Patagoniafresh" class="logo">
        <h1>Registro diario de superficie Patagoniafresh 2025-2026</h1>
    </header>
    
    <div class="button-container">
        <a href="https://lookerstudio.google.com/reporting/119433e9-695e-4c3c-bc32-c7cdecf8c1f2" class="btn">
            <i class="fas fa-chart-line"></i> Revisar estadísticas
        </a>
        <a href="https://docs.google.com/spreadsheets/d/1ey1OEBS4XAfQspcxFVbw6s_7A68QUWLLnmkPGTtnoB4/export?format=xlsx" class="btn">
            <i class="fas fa-download"></i> Descargar estadísticas
        </a>
    </div>
    
    <div class="form-container">
        <form id="registroForm">
            <div class="form-section">
                <h2><i class="fas fa-user"></i> Zonal a cargo</h2>
                <div class="form-group">
                    <label for="zonal">Seleccione zonal:</label>
                    <select id="zonal" name="zonal" required>
                        <option value="">-- Seleccione --</option>
                        <option value="Eugenio Cornejo">Eugenio Cornejo</option>
                        <option value="Fabian Cornejo">Fabian Cornejo</option>
                        <option value="Juan Soto">Juan Soto</option>
                        <option value="Victor Olivares">Victor Olivares</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="agricultor">Agricultor y contrato:</label>
                    <select id="agricultor" name="agricultor" required disabled>
                        <option value="">-- Seleccione primero un zonal --</option>
                    </select>
                </div>
            </div>
            
            <div class="form-section">
                <h2><i class="fas fa-seedling"></i> Variedad a trasplantar</h2>
                <div class="form-group">
                    <label for="variedad">Seleccione variedad:</label>
                    <select id="variedad" name="variedad" required>
                        <option value="">-- Seleccione --</option>
                        <option value="BQ 273">BQ 273</option>
                        <option value="BQ 400">BQ 400</option>
                        <option value="H 1015">H 1015</option>
                        <option value="H 1776">H 1776</option>
                        <option value="H 1996">H 1996</option>
                        <option value="H 2010">H 2010</option>
                        <option value="H 2016">H 2016</option>
                        <option value="H 2123">H 2123</option>
                        <option value="H 2365">H 2365</option>
                        <option value="H 3402">H 3402</option>
                        <option value="H 5508">H 5508</option>
                        <option value="H 7709">H 7709</option>
                        <option value="HM 4521">HM 4521</option>
                        <option value="HM 5908">HM 5908</option>
                        <option value="HM 7883">HM 7883</option>
                        <option value="HM 8237">HM 8237</option>
                        <option value="LS 266">LS 266</option>
                        <option value="N 0296">N 0296</option>
                        <option value="N 6428">N 6428</option>
                        <option value="SVTM 9018">SVTM 9018</option>
                    </select>
                </div>
            </div>
            
            <div class="form-section">
                <h2><i class="fas fa-tractor"></i> Máquina trasplantadora</h2>
                <div class="form-group">
                    <label for="maquina">Seleccione máquina:</label>
                    <select id="maquina" name="maquina" required>
                        <option value="">-- Seleccione --</option>
                        <option value="TO0000012">TO0000012 CyC</option>
                        <option value="TO0000013">TO0000013 CyC</option>
                        <option value="TO0000014">TO0000014 CyC</option>
                        <option value="TO0000015">TO0000015 CyC</option>
                        <option value="TO0000001">TO0000001 Servimak</option>
                        <option value="TO0000002">TO0000002 Servimak</option>
                        <option value="TO0000003">TO0000003 Servimak</option>
                        <option value="TO0000004">TO0000004 Servimak</option>
                        <option value="TO0000005">TO0000005 Servimak</option>
                        <option value="LIT120011">LIT120011 Lizana</option>
                        <option value="LIT120012">LIT120012 Lizana</option>
                        <option value="LIT120013">LIT120013 Lizana</option>
                        <option value="LIT120014">LIT120014 Lizana</option>
                        <option value="LIT120015">LIT120015 CMuñoz</option>
                        <option value="TO0000016">TO0000016 Propia</option>
                        <option value="LIT120016">LIT120016 Agricola y Serv el Huique SPA</option>
                        <option value="LIT120017">LIT120017 Agricola y Serv el Huique SPA</option>
                        <option value="LIT120021">LIT120021 Agricola y Serv el Huique SPA</option>
                        <option value="LIT120022">LIT120022 Agricola y Serv el Huique SPA</option>
                    </select>
                </div>
            </div>
            
            <div class="form-section">
                <h2><i class="far fa-calendar-alt"></i> Fecha</h2>
                <div class="form-group">
                    <label for="fecha">Seleccione fecha:</label>
                    <input type="date" id="fecha" name="fecha" required>
                </div>
            </div>
            
            <div class="form-section">
                <h2><i class="fas fa-ruler-combined"></i> Superficie</h2>
                <div class="form-group">
                    <label for="hectareas">Hectáreas trasplantadas (use coma para decimales, ej: 3,2):</label>
                    <input type="text" id="hectareas" name="hectareas" placeholder="Ej: 5,3" required pattern="[0-9]+([,][0-9]+)?">
                </div>
            </div>
            
            <button type="submit" class="submit-btn"><i class="fas fa-save"></i> Grabar información</button>
        </form>
    </div>
    
    <!-- Modal de confirmación -->
    <div class="modal" id="confirmModal">
        <div class="modal-content">
            <h3 class="modal-title">Confirmar datos</h3>
            <div class="modal-data" id="confirmData"></div>
            <div class="modal-buttons">
                <button class="modal-btn modal-confirm" id="confirmYes">Sí, confirmar</button>
                <button class="modal-btn modal-cancel" id="confirmNo">Volver a modificar</button>
            </div>
        </div>
    </div>
    
    <!-- Modal de éxito -->
    <div class="modal" id="successModal">
        <div class="modal-content success-modal">
            <div class="success-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <h3 class="modal-title">¡Excelente colega!</h3>
            <p>Sus datos han sido guardados exitosamente :)</p>
            <p>En 3 segundos se limpiará el formulario y podrá seguir grabando datos.</p>
        </div>
    </div>
    
    <footer>
        <p>Esta aplicación web ha sido creada por el área agrícola de Patagoniafresh</p>
    </footer>

    <script>
        // Datos de agricultores por zonal
        const agricultoresPorZonal = {
            "Eugenio Cornejo": ["AGRICOLA CINCO TESOROS SPA 792600072 41",
"Zapata Barahona Benjamin Andres 792600277 20",
"Yañez Martinez Jorge Andres 792600285 20",
"Contreras Correa Miguel Angel 792600293 42",
"MUÑOZ MARDONES MARGARITA DE LAS ROSAS 792600307 10,5",
"VILLARROEL NEIRA JOSE BRIGADIER 792600315 11,5",
"Quiroga Ramirez Alvaro Efrain 792600323 10",
"Agrícola y Servicios Pin Pin Spa 792600358 21",
"Agrocomercial Gabriel Absalon Cornejo Briones E.I.R.L 792600366 29",
"Agrocomercial Luis Daniel Cornejo Briones E.I.R.L 792600374 13",
"Fuenzalida Galaz Marcos Jesús 792600382 20",
"DURAN ROJAS MARCELO ANDRES 792600390 18",
"DURAN ROJAS MARCELO ANDRES 792600404 22",
"Carlos Barahona Urzua E.I.R.L 792600412 16",
"Mauricio Rojas Gomez E.I.R.L 79260034K 11",
"TORRES ARAVENA VICTOR ANTONIO 792600447 9",
"TORRES ARAVENA VICTOR ANTONIO 792600455 19",
"TORRES ARAVENA VICTOR ANTONIO 792600463 24",
"ROJAS GOMEZ MAURICIO ANTONIO 792600498 16",
"Mauricio Rojas Gomez E.I.R.L 792600501 60",
"Ramirez Tapia Luis Humberto del Carmen 792600528 23"
],
            "Fabian Cornejo": ["Pino Saavedra Marcelo Enrique 792600137 36",
"Pino Saavedra Marcelo Enrique 792600145 14",
"Agricola La Cabaña Spa 792600196 21",
"Agricola La Cabaña Spa 792600218 16",
"Agricola La Cabaña Spa 792600226 23",
"Agricola La Cabaña Spa 79260020K 30",
"Ramon Cea Vargas 792600250 30",
"Muñoz Morales Tito Carmen 79260048K 12",
"AB INGENIEROS SPA 792600331 22",
"Catalan Zavalla Hugo Patricio 792600439 18",
"Catalan Zavalla Hugo Patricio 792600536 24",
"BIGNOTTI DIAZ DANILO VICENTE 792600544 15",
"LOPEZ CATALAN HENDRY ESTEBAN 792600552 14",
"LOPEZ CATALAN HENDRY ESTEBAN 792600560 12",
"LOPEZ CATALAN HENDRY ESTEBAN 792600579 9",
"FRUTICOLA VICONTO S.A. 792600692 13"
],
            "Juan Soto": ["Lopez Diaz Helia Eufemia 792600080 15,5",
"Agricola Lomas de Alquihue Spa 792600099 40",
"GARRIDO MORALES MAURICIO ANTONIO 792600129 18",
"Agricola Los Peumos Spa. 792600153 15",
"Agricola Lomas de Alquihue Spa 792600242 50",
"Barrera Diaz Daniel Antonio 792600587 5",
"Agricola Terrandes S.A. 802600056 5",
"Agricola Terrandes S.A. 802600021 15",
"Agricola Terrandes S.A. 802600064 10",
"Agricola Terrandes S.A. 802600056 20",
"LAGOS NAVARRETE ROBERTO PATRICIO 792600595 30",
"LAGOS NAVARRETE ROBERTO PATRICIO 792600609 12",
"Agricola Ramon Melendez Valenzuela E.I.R.L. 792600633 20",
"Barrera Palma Manuel Antonio 792600684 13",
"Letelier Guajardo José Omar 792600722 30",
"Letelier Guajardo José Omar 792600730 30"
],
            "Victor Olivares": [
"AGRICOLA MARIA VALEKA GALDAMES EIRL 792600161 16",
"AMARO GONZALEZ CLAUDIO ANTONIO 792600188 10",
"Amaro Loyola Claudio Antonio 79260017K 10",
"Agrícola Alcaino Spa 792600234 20",
"LABRA ROJAS IVAN ANTONIO 792600420 13",
"SOCIEDAD AGRICOLA LABRA SPA 792600471 13",
"URETA CASTAÑEDA EDMUNDO ANDRES 79260051K 10",
"Amaro Loyola Claudio Antonio 792600617 5",
"AMARO GONZALEZ CLAUDIO ANTONIO 792600625 5",
"Sociedad Agricola Doña Francisca Ltda 792600641 19",
"Sociedad Agricola Doña Francisca Ltda 792600668 11",
"AGRICOLA SANTA MARTA SPA 792600676 15",
"Agrícola y Comercial Claudio Amaro Ltda 79260065K 9",
"AGRICOLA SANTA RITA SPA 792600706 15",
"Pozo Merino Gaston Del Carmen 792600749 27",
"PATAGONIAFRESH S.A. 912600013 42",
"PATAGONIAFRESH S.A. 91260003K 23",
"PATAGONIAFRESH S.A. 912600021 50"
]
        };
        
        // Elementos del DOM
        const zonalSelect = document.getElementById('zonal');
        const agricultorSelect = document.getElementById('agricultor');
        const formulario = document.getElementById('registroForm');
        const confirmModal = document.getElementById('confirmModal');
        const successModal = document.getElementById('successModal');
        const confirmData = document.getElementById('confirmData');
        const confirmYes = document.getElementById('confirmYes');
        const confirmNo = document.getElementById('confirmNo');
        
        // Cargar agricultores cuando se selecciona un zonal
        zonalSelect.addEventListener('change', function() {
            const zonal = this.value;
            
            if (zonal) {
                agricultorSelect.disabled = false;
                agricultorSelect.innerHTML = '<option value="">-- Seleccione agricultor --</option>';
                
                agricultoresPorZonal[zonal].forEach(agricultor => {
                    const option = document.createElement('option');
                    option.value = agricultor;
                    option.textContent = agricultor;
                    agricultorSelect.appendChild(option);
                });
            } else {
                agricultorSelect.disabled = true;
                agricultorSelect.innerHTML = '<option value="">-- Seleccione primero un zonal --</option>';
            }
        });
        
        // Manejar envío del formulario
        formulario.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Validar hectáreas
            const hectareasInput = document.getElementById('hectareas');
            const hectareasValue = hectareasInput.value.replace(',', '.');
            
            if (isNaN(parseFloat(hectareasValue))) {
                alert('Por favor, ingrese un valor numérico válido para las hectáreas.');
                hectareasInput.focus();
                return;
            }
            
            // Mostrar datos en modal de confirmación
            const formData = new FormData(formulario);
            const datos = {
                zonal: formData.get('zonal'),
                agricultor: formData.get('agricultor'),
                variedad: formData.get('variedad'),
                maquina: formData.get('maquina'),
                fecha: formData.get('fecha'),
                hectareas: parseFloat(hectareasValue)
            };
            
            confirmData.innerHTML = `
                <p><strong>Zonal:</strong> ${datos.zonal}</p>
                <p><strong>Agricultor y contrato:</strong> ${datos.agricultor}</p>
                <p><strong>Variedad:</strong> ${datos.variedad}</p>
                <p><strong>Máquina:</strong> ${datos.maquina}</p>
                <p><strong>Fecha:</strong> ${datos.fecha}</p>
                <p><strong>Hectáreas:</strong> ${datos.hectareas} Ha</p>
            `;
            
            confirmModal.style.display = 'flex';
        });
        
        // Manejar botones del modal de confirmación
        confirmNo.addEventListener('click', function() {
            confirmModal.style.display = 'none';
        });
        
        confirmYes.addEventListener('click', function() {
            confirmModal.style.display = 'none';
            enviarDatosGoogleSheets();
        });
        
        // Función para enviar datos a Google Sheets
        function enviarDatosGoogleSheets() {
            const formData = new FormData(formulario);
            const hectareasValue = document.getElementById('hectareas').value.replace(',', '.');
            
            // Obtener fecha y hora actual
            const ahora = new Date();
            const fechaHora = ahora.toLocaleString('es-CL');
            
            // Preparar datos para enviar
            const datos = {
                timestamp: fechaHora,
                zonal: formData.get('zonal'),
                agricultor: formData.get('agricultor'),
                variedad: formData.get('variedad'),
                maquina: formData.get('maquina'),
                fecha: formData.get('fecha'),
                hectareas: parseFloat(hectareasValue)
            };
            
            // Enviar datos a Google Sheets
            enviarDatosRealGoogleSheets(datos);
        }
        
        // Función para enviar datos a Google Sheets
        function enviarDatosRealGoogleSheets(datos) {
            // URL de tu Web App de Google Apps Script
            // REEMPLAZA ESTA URL CON LA DE TU PROPIO SCRIPT
            const scriptURL = 'https://script.google.com/macros/s/AKfycbyf5zpSW8XyZ2Kgjkb4aWDbsLz5XJKqaoVzxusrn8UEGAUifNWhmoRUVmiZd5m5D8lryQ/exec';
            
            // Mostrar mensaje de carga
            successModal.style.display = 'flex';
            successModal.querySelector('.modal-title').textContent = 'Enviando datos...';
            successModal.querySelector('.success-icon').innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
            successModal.querySelector('p').textContent = 'Por favor espere, estamos guardando su información.';
            
            fetch(scriptURL, {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(datos)
            })
            .then(() => {
                // Mostrar mensaje de éxito
                successModal.querySelector('.modal-title').textContent = '¡Excelente colega!';
                successModal.querySelector('.success-icon').innerHTML = '<i class="fas fa-check-circle"></i>';
                successModal.querySelector('p').textContent = 'Sus datos han sido guardados exitosamente :)';
                successModal.querySelector('p').nextElementSibling.textContent = 'En 3 segundos se limpiará el formulario y podrá seguir grabando datos.';
                
                // Ocultar modal después de 3 segundos y resetear formulario
                setTimeout(function() {
                    successModal.style.display = 'none';
                    formulario.reset();
                    agricultorSelect.disabled = true;
                    agricultorSelect.innerHTML = '<option value="">-- Seleccione primero un zonal --</option>';
                }, 3000);
            })
            .catch(error => {
                console.error('Error al enviar datos:', error);
                
                // Mostrar mensaje de error
                successModal.querySelector('.modal-title').textContent = 'Error';
                successModal.querySelector('.success-icon').innerHTML = '<i class="fas fa-exclamation-circle" style="color:#f44336"></i>';
                successModal.querySelector('p').textContent = 'Hubo un error al enviar los datos. Por favor, intente nuevamente.';
                successModal.querySelector('p').nextElementSibling.textContent = '';
                
                // Ocultar modal después de 5 segundos
                setTimeout(function() {
                    successModal.style.display = 'none';
                }, 3000);
            });
        }
    </script>
</body>
</html>
